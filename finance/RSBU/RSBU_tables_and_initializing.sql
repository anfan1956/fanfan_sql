if OBJECT_ID('acc.RSBU_subaccounts') is not null drop table acc.RSBU_subaccounts
if OBJECT_ID('acc.RSBU_accounts') is not null drop table acc.RSBU_accounts
if OBJECT_ID('acc.RSBU_sections') is not null drop table acc.RSBU_sections

create table acc.RSBU_sections (
sectionid int not null identity primary key,
section varchar (50) not null unique
)

create table acc.RSBU_accounts (
accountid int not null identity primary key,
account varchar (250) null, 
sectionid int not null foreign key references acc.RSBU_sections (sectionid)
)

create table acc.RSBU_subaccounts(
	subaccountid int not null identity primary key, 
	subaccount_num int not null, 
	subaccount varchar(250),
	accountid int not null foreign key references acc.RSBU_accounts (accountid)
	constraint uq_RSBU_sub unique (subaccount_num, accountid)
)


insert acc.RSBU_sections(section)  values
('ВНЕОБОРОТНЫЕ АКТИВЫ'), 
('ПРОИЗВОДСТВЕННЫЕ ЗАПАСЫ'), 
('ЗАТРАТЫ НА ПРОИЗВОДСТВО'), 
('ГОТОВАЯ ПРОДУКЦИЯ И ТОВАРЫ'), 
('ДЕНЕЖНЫЕ СРЕДСТВА'), 
('РАСЧЕТЫ'), 
('КАПИТАЛ'), 
('ФИНАНСОВЫЕ РЕЗУЛЬТАТЫ')

insert acc.RSBU_accounts (account, sectionid) values 
('Основные средства', 1), 
('Амортизация основных средств', 1), 
('Доходные вложения в материальные ценности', 1), 
('Нематериальные активы', 1), 
('Амортизация нематериальных активов', 1), 
('..............................', 1), 
('Оборудование к установке', 1), 
('Вложения во внеоборотные активы', 1), 
('Отложенные налоговые активы', 1), 
('Материалы', 2), 
('Животные на выращивании и откорме', 2), 
('..............................', 2), 
('..............................', 2), 
('Резервы под снижение стоимости материальных ценностей', 2), 
('Заготовление и приобретение материальных ценностей', 2), 
('Отклонение в стоимости материальных ценностей', 2), 
('..............................', 2), 
('..............................', 2), 
('Налог на добавленную стоимость по приобретенным ценностям', 2), 
('Основное производство', 3), 
('Полуфабрикаты собственного производства', 3), 
('..............................', 3), 
('Вспомогательные производства', 3), 
('..............................', 3), 
('Общепроизводственные расходы', 3), 
('Общехозяйственные расходы', 3), 
('..............................', 3), 
('Брак в производстве', 3), 
('Обслуживающие производства и хозяйства', 3), 
('..............................', 3), 
('..............................', 3), 
('..............................', 3), 
('..............................', 3), 
('..............................', 3), 
('..............................', 3), 
('..............................', 3), 
('..............................', 3), 
('..............................', 3), 
('..............................', 3), 
('Выпуск продукции (работ, услуг)', 4), 
('Товары', 4), 
('Торговая наценка', 4), 
('Готовая продукция', 4), 
('Расходы на продажу', 4), 
('Товары отгруженные', 4), 
('Выполненные этапы по незавершенным работам', 4), 
('..............................', 4), 
('..............................', 4), 
('..............................', 4), 
('Касса', 5), 
('Расчетные счета', 5), 
('Валютные счета', 5), 
('..............................', 5), 
('..............................', 5), 
('Специальные счета в банках', 5), 
('..............................', 5), 
('Переводы в пути', 5), 
('Финансовые вложения', 5), 
('Резервы под обесценение финансовых вложений', 5), 
('Расчеты с поставщиками и подрядчиками', 6), 
('..............................', 6), 
('Расчеты с покупателями и заказчиками', 6), 
('Резервы по сомнительным долгам', 6), 
('..............................', 6), 
('..............................', 6), 
('Расчеты по краткосрочным кредитам и займам', 6), 
('Расчеты по долгосрочным кредитам и займам', 6), 
('Расчеты по налогам и сборам', 6), 
('Расчеты по социальному страхованию и обеспечению', 6), 
('Расчеты с персоналом по оплате труда', 6), 
('Расчеты с подотчетными лицами', 6), 
('..............................', 6), 
('Расчеты с персоналом по прочим операциям', 6), 
('..............................', 6), 
('Расчеты с учредителями', 6), 
('Расчеты с разными дебиторами и кредиторами', 6), 
('Отложенные налоговые обязательства', 6), 
('..............................', 6), 
('Внутрихозяйственные расчеты', 6), 
('Уставный капитал', 7), 
('Собственные акции (доли)', 7), 
('Резервный капитал', 7), 
('Добавочный капитал', 7), 
('Нераспределенная прибыль (непокрытый убыток)', 7), 
('..............................', 7), 
('Целевое финансирование', 7), 
('..............................', 7), 
('..............................', 7), 
('..............................', 7), 
('Продажи', 8), 
('Прочие доходы и расходы', 8), 
('..............................', 8), 
('..............................', 8), 
('Недостачи и потери от порчи ценностей', 8), 
('..............................', 8), 
('Резервы предстоящих расходов', 8), 
('Расходы будущих периодов', 8), 
('Доходы будущих периодов', 8), 
('Прибыли и убытки', 8) 


insert acc.RSBU_subaccounts(subaccount_num, subaccount, accountid) values 
(1,  '', 1), 
(1,  '', 2), 
(1,  '', 3), 
(1,  '', 4), 
(1,  '', 5), 
(1,  '', 6), 
(1,  '', 7), 
(1,  ' Приобретение земельных участков', 8), 
(2,  ' Приобретение объектов природопользования', 8), 
(3,  ' Строительство объектов основных средств', 8), 
(4,  ' Приобретение объектов основных средств', 8), 
(5,  ' Приобретение нематериальных активов', 8), 
(6,  ' Перевод молодняка животных в основное стадо', 8), 
(7,  ' Приобретение взрослых животных', 8), 
(8,  ' Выполнение научно-исследовательских, опытно-конструкторских и технологических работ', 8), 
(1,  '', 9), 
(1,  ' Сырье и материалы', 10), 
(2,  ' Покупные полуфабрикаты и комплектующие изделия, конструкции и детали', 10), 
(3,  ' Топливо', 10), 
(4,  ' Тара и тарные материалы', 10), 
(5,  ' Запасные части', 10), 
(6,  ' Прочие материалы', 10), 
(7,  ' Материалы, переданные в переработку на сторону', 10), 
(8,  ' Строительные материалы', 10), 
(9,  ' Инвентарь и хозяйственные принадлежности', 10), 
(10,  ' Специальная оснастка и специальная одежда на складе', 10), 
(11,  ' Специальная оснастка и специальная одежда в эксплуатации', 10), 
(1,  '', 11), 
(1,  '', 12), 
(1,  '', 13), 
(1,  '', 14), 
(1,  '', 15), 
(1,  '', 16), 
(1,  '', 17), 
(1,  '', 18), 
(1,  ' Налог на добавленную стоимость при приобретении основных средств', 19), 
(2,  ' Налог на добавленную стоимость по приобретенным нематериальным активам', 19), 
(3,  ' Налог на добавленную стоимость по приобретенным материально-производственным запасам', 19), 
(1,  '', 20), 
(1,  '', 21), 
(1,  '', 22), 
(1,  '', 23), 
(1,  '', 24), 
(1,  '', 25), 
(1,  '', 26), 
(1,  '', 27), 
(1,  '', 28), 
(1,  '', 29), 
(1,  '', 30), 
(1,  '', 31), 
(1,  '', 32), 
(1,  '', 33), 
(1,  '', 34), 
(1,  '', 35), 
(1,  '', 36), 
(1,  '', 37), 
(1,  '', 38), 
(1,  '', 39), 
(1,  '', 40), 
(1,  ' Товары на складах', 41), 
(2,  ' Товары в розничной торговле', 41), 
(3,  ' Тара под товаром и порожняя', 41), 
(4,  ' Покупные изделия', 41), 
(1,  '', 42), 
(1,  '', 43), 
(1,  '', 44), 
(1,  '', 45), 
(1,  '', 46), 
(1,  '', 47), 
(1,  '', 48), 
(1,  '', 49), 
(1,  ' Касса организации', 50), 
(2,  ' Операционная касса', 50), 
(3,  ' Денежные документы', 50), 
(1,  '', 51), 
(1,  '', 52), 
(1,  '', 53), 
(1,  '', 54), 
(1,  ' Аккредитивы', 55), 
(2,  ' Чековые книжки', 55), 
(3,  ' Депозитные счета', 55), 
(1,  '', 56), 
(1,  '', 57), 
(1,  ' Паи и акции', 58), 
(2,  ' Долговые ценные бумаги', 58), 
(3,  ' Предоставленные займы', 58), 
(4,  ' Вклады по договору простого товарищества', 58), 
(1,  '', 59), 
(1,  '', 60), 
(1,  '', 61), 
(1,  '', 62), 
(1,  '', 63), 
(1,  '', 64), 
(1,  '', 65), 
(1,  '', 66), 
(1,  '', 67), 
(1,  '', 68), 
(1,  ' Расчеты по социальному страхованию', 69), 
(2,  ' Расчеты по пенсионному обеспечению', 69), 
(3,  ' Расчеты по обязательному медицинскому страхованию', 69), 
(1,  '', 70), 
(1,  '', 71), 
(1,  '', 72), 
(1,  ' Расчеты по предоставленным займам', 73), 
(2,  ' Расчеты по возмещению материального ущерба', 73), 
(1,  '', 74), 
(1,  ' Расчеты по вкладам в уставный (складочный) капитал', 75), 
(2,  ' Расчеты по выплате доходов', 75), 
(1,  ' Расчеты по имущественному и личному страхованию', 76), 
(2,  ' Расчеты по претензиям', 76), 
(3,  ' Расчеты по причитающимся дивидендам и другим доходам', 76), 
(4,  ' Расчеты по депонированным суммам', 76), 
(1,  '', 77), 
(1,  '', 78), 
(1,  ' Расчеты по выделенному имуществу', 79), 
(2,  ' Расчеты по текущим операциям', 79), 
(3,  ' Расчеты по договору доверительного управления имуществом', 79), 
(1,  '', 80), 
(1,  '', 81), 
(1,  '', 82), 
(1,  '', 83), 
(1,  '', 84), 
(1,  '', 85), 
(1,  '', 86), 
(1,  '', 87), 
(1,  '', 88), 
(1,  '', 89), 
(1,  ' Выручка', 90), 
(2,  ' Себестоимость продаж', 90), 
(3,  ' Налог на добавленную стоимость', 90), 
(4,  ' Акцизы', 90), 
(9,  ' Прибыль / убыток от продаж', 90), 
(1,  ' Прочие доходы', 91), 
(2,  ' Прочие расходы', 91), 
(9,  ' Сальдо прочих доходов и расходов', 91), 
(1,  '', 92), 
(1,  '', 93), 
(1,  '', 94), 
(1,  '', 95), 
(1,  '', 96), 
(1,  '', 97), 
(1,  ' Доходы, полученные в счет будущих периодов', 98), 
(2,  ' Безвозмездные поступления', 98), 
(3,  ' Предстоящие поступления задолженности по недостачам, выявленным за прошлые годы', 98), 
(4,  ' Разница между суммой, подлежащей взысканию с виновных лиц, и балансовой стоимостью по недостачам ценностей', 98), 
(1,  '', 99) 






select * from acc.RSBU_sections order by 1
select s.sectionid, s.section, a.accountid, a.account from acc.RSBU_accounts a 
	join acc.RSBU_sections s on s.sectionid=a.sectionid
order by 1, 3 



select sec.sectionid,  sec.section, a.accountid, a.account, s.subaccount_num, s.subaccount 
from acc.RSBU_subaccounts s
	join acc.RSBU_accounts a on a.accountid=s.accountid
	join acc.RSBU_sections sec on sec.sectionid=a.sectionid
order by 1, 3, 5
select * From acc.accounts a

 